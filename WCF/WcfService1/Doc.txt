
WCF - Windows Communication Foundation
System.ServiceModel
合并了ASP.NetWeb服务、.Net Remoting、消息队列、Enterprise Services

WCF支持的通信协议

SOAP 协议
Sample Object Access Protocol
可发送XML架构定义消息	
包含信封：标题、正文

WSDL 协议
Web Service Description Language

REST

JSON

Address 
EndpointAddress

Binding
	Name
	NameSpace
	Binding Element
		Encoding Binding Element :描述数据的编码方式；
		Transport Binding Element ：描述数据的传输方式；
		Protocol Binding Element :指定安全性 可靠性 上下文流设置

消息交换模式
	One-Way Calls 
	Request/Reply
	Duplex

步骤：
1.定义契约（协定）：

	四种主要协定：
	a.服务协定：指明该类（结构）或方法可被远程调用
		Service Contract 包含：ServiceContract（用于类与结构体）与OperationContract（用于方法）
	b.数据协定：指明该类或者属性可以被远程序列化并传输
		DataContract（用于类或者结构体）、MemberContract（用于属性或者字段）
	c.异常协定：自定义异常消息格式
		FaultContract
	d.消息协定：自定义消息结构
		指定消息头、消息体、是否对内容进行加密或签名；



1.服务创建

	定义协定 实现服务
	1.1 定义协定 - 接口
	1.2 定义实现 - 服务行为
	1.3 定义绑定 - 数据传输

2.寄宿发布服务

	定义宿主 开启服务
	配置服务config
	2.1 寄宿到Windows服务；
	2.2 寄宿到IIS；
	2.3 寄宿到应用程序等；
	3.4 服务发布（运行）

3.客户端获取服务
	
	客户端需要使用代理访问服务
	创建代理三种方式：
	3.1 VS添加服务引用  -  自动创建代理类
	3.2 ServiceModel 元数据实用工具（Svcutil.exe） -  使用该工具创建代理类型
	3.3 ChannelFactory类 

	Mark： WSDL文档 （由MEX端点创建，由服务配置）

		使用元数据：
		共享类型 ： 
			代理类派生在基类ClientBase<TChannel> 或者使用ChannelFactory<TChannel>
			需要绑定和端点
			
4.双工通信
	
	必须指定在客户端实现的协议
	并发与死锁
	ConcurrencyMode
	OperationContext类
	OperationContext.Current返回与客户端中当前请求关联的OperationContext
	服务端回调 获取回调信道

	客户端:
		1.启动与服务端连接：不能使用ChannelFactory 需使用 DuplexChannelFactory类
			eg: var context =new InstanceContext(TCallBack);
				var factory = new DuplexChannelFactory<TChannel>(context,Binding,Address);
	
	路由
		SOAP协议的高级特性
		RouterService











